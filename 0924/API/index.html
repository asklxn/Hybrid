<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ëŠ˜ ë¯¸ì„¸ë¨¼ì§€ ì˜ˆë³´ ğŸŒ¬ï¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* ì „ì²´ ìŠ¤íƒ€ì¼ ë° í°íŠ¸ */
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #e0f2f7 0%, #e8eaf6 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
        }
        .container {
            max-width: 1200px;
            width: 90%;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 30px 0;
        }
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header-content {
            text-align: center;
            margin-bottom: 30px;
        }
        .date-info {
            font-size: 1.2em;
            color: #777;
            font-weight: 500;
            margin-bottom: 10px;
        }
        h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin: 0;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        .message-box {
            font-size: 1.1em;
            font-weight: 400;
            color: #444;
            padding: 10px 20px;
            border-radius: 8px;
            display: inline-block;
            margin-top: 15px;
        }
        /* ë©”ì‹œì§€ë³„ ìƒ‰ìƒ */
        .message-good { background-color: #d4edda; color: #155724; }
        .message-normal { background-color: #fff3cd; color: #856404; }
        .message-bad { background-color: #f8d7da; color: #721c24; }
        .message-very-bad { background-color: #e2d4f5; color: #4b306b; }
        
        /* ì¹´ë“œ ì»¨í…Œì´ë„ˆ */
        #forecast-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        /* ê°œë³„ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .forecast-card {
            border-radius: 15px;
            padding: 25px 15px;
            text-align: center;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: default;
        }
        .forecast-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
        }
        .region-name {
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        .grade {
            font-size: 1.5em;
            font-weight: 500;
            padding: 5px 0;
            border-radius: 5px;
        }
        /* ë“±ê¸‰ë³„ ì¹´ë“œ ìƒ‰ìƒ ë° í…ìŠ¤íŠ¸ */
        .good { background-color: #e6ffed; border: 1px solid #28a745; color: #28a745; }
        .normal { background-color: #fff8e1; border: 1px solid #ffc107; color: #ffc107; }
        .bad { background-color: #ffebeb; border: 1px solid #dc3545; color: #dc3545; }
        .very-bad { background-color: #f1e6ff; border: 1px solid #6f42c1; color: #6f42c1; }
        .unknown { background-color: #f0f0f0; border: 1px solid #999; color: #666; }
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 50px auto;
            display: block;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error-message {
            text-align: center;
            color: #dc3545;
            font-size: 1.1em;
            margin-top: 50px;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header-content">
            <div id="date-info" class="date-info"></div>
            <h1>ğŸ˜· ì˜¤ëŠ˜ ë¯¸ì„¸ë¨¼ì§€ ì˜ˆë³´ ğŸŒ¬ï¸</h1>
            <div id="message-box" class="message-box"></div>
        </div>
        
        <div id="loading" class="loading-spinner"></div>
        <div id="forecast-container">
            </div>
        <div id="error-display" class="error-message" style="display:none;"></div>
    </div>

    <script>
        const serviceKey = 'eb3fe0ecf5b8e41900f5b508862729b504f50c1ce71910b50983a605f9d41afd';
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');
        const searchDate = `${year}-${month}-${day}`;

        const dayNames = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];
        const dayOfWeek = dayNames[today.getDay()];

        const url = `http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getMinuDustFrcstDspth?serviceKey=${serviceKey}&returnType=json&numOfRows=100&pageNo=1&searchDate=${searchDate}&informCode=PM10`;

        // ë‚ ì§œ ë° ìš”ì¼ í‘œì‹œ
        document.getElementById('date-info').textContent = `${year}ë…„ ${month}ì›” ${day}ì¼ (${dayOfWeek})`;

        async function fetchForecastData() {
            const loadingSpinner = document.getElementById('loading');
            const forecastContainer = document.getElementById('forecast-container');
            const errorDisplay = document.getElementById('error-display');
            const messageBox = document.getElementById('message-box');
            
            loadingSpinner.style.display = 'block';
            forecastContainer.innerHTML = '';
            errorDisplay.style.display = 'none';
            messageBox.className = 'message-box'; // ê¸°ì¡´ í´ë˜ìŠ¤ ì´ˆê¸°í™”
            messageBox.textContent = 'ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';

            try {
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`API í˜¸ì¶œ ì‹¤íŒ¨: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                
                if (data.response.header.resultCode !== '00') {
                    throw new Error(`API ì˜¤ë¥˜: ${data.response.header.resultMsg}`);
                }

                const items = data.response.body.items;

                if (items && items.length > 0) {
                    const forecastData = items[0]; 
                    const gradesString = forecastData.informGrade;
                    const gradesArray = gradesString.split(',').map(s => s.trim());

                    let overallGrade = '';
                    if (forecastData.informOverall.includes('ì¢‹ìŒ')) {
                        overallGrade = 'ì¢‹ìŒ';
                    } else if (forecastData.informOverall.includes('ë³´í†µ')) {
                        overallGrade = 'ë³´í†µ';
                    } else if (forecastData.informOverall.includes('ë‚˜ì¨')) {
                        overallGrade = 'ë‚˜ì¨';
                    } else if (forecastData.informOverall.includes('ë§¤ìš°ë‚˜ì¨')) {
                        overallGrade = 'ë§¤ìš°ë‚˜ì¨';
                    }

                    // ë¬¸êµ¬ ë° ìƒ‰ìƒ ì—…ë°ì´íŠ¸
                    let messageText = '';
                    let messageClass = '';

                    switch (overallGrade) {
                        case 'ì¢‹ìŒ':
                            messageText = 'ğŸ¥³ ê³µê¸°ê°€ ë§¤ìš° ì¢‹ì•„ìš”! ì‚°ì±…ì´ë‚˜ ì•¼ì™¸ í™œë™í•˜ê¸° ì¢‹ì€ ë‚ ì´ì—ìš”.';
                            messageClass = 'message-good';
                            break;
                        case 'ë³´í†µ':
                            messageText = 'ğŸ™‚ ë³´í†µ ìˆ˜ì¤€ì˜ ê³µê¸°ì˜ˆìš”. í‰ì†Œì²˜ëŸ¼ í™œë™í•´ë„ ê´œì°®ì•„ìš”.';
                            messageClass = 'message-normal';
                            break;
                        case 'ë‚˜ì¨':
                            messageText = 'ğŸ˜¥ ê³µê¸°ê°€ íƒí•˜ë‹ˆ, ì™¸ì¶œ ì‹œ ë§ˆìŠ¤í¬ë¥¼ ì°©ìš©í•˜ì„¸ìš”.';
                            messageClass = 'message-bad';
                            break;
                        case 'ë§¤ìš°ë‚˜ì¨':
                            messageText = 'ğŸ˜· ê³µê¸°ê°€ ë§¤ìš° ë‚˜ë¹ ìš”. ì™¸ì¶œì„ ìì œí•˜ê³  ì‹¤ë‚´ì— ë¨¸ë¬´ë¥´ëŠ” ê²ƒì´ ì¢‹ì•„ìš”.';
                            messageClass = 'message-very-bad';
                            break;
                        default:
                            messageText = 'í˜„ì¬ ëŒ€ê¸° ìƒíƒœì— ëŒ€í•œ ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                            messageClass = '';
                            break;
                    }

                    messageBox.textContent = messageText;
                    messageBox.classList.add(messageClass);

                    gradesArray.forEach(regionInfo => {
                        const parts = regionInfo.split(':');
                        if (parts.length !== 2) return;
                        const region = parts[0].trim();
                        const grade = parts[1].trim();
                        
                        let statusClass = 'unknown';
                        if (grade.includes('ì¢‹ìŒ')) {
                            statusClass = 'good';
                        } else if (grade.includes('ë³´í†µ')) {
                            statusClass = 'normal';
                        } else if (grade.includes('ë‚˜ì¨')) {
                            statusClass = 'bad';
                        } else if (grade.includes('ë§¤ìš°ë‚˜ì¨')) {
                            statusClass = 'very-bad';
                        }
                        
                        const cardDiv = document.createElement('div');
                        cardDiv.className = `forecast-card ${statusClass}`;
                        cardDiv.innerHTML = `
                            <div class="region-name">${region}</div>
                            <div class="grade">${grade}</div>
                        `;
                        forecastContainer.appendChild(cardDiv);
                    });
                } else {
                    forecastContainer.innerHTML = '<p style="text-align:center; color:#777;">í˜„ì¬ ë¯¸ì„¸ë¨¼ì§€ ì˜ˆë³´ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                    messageBox.textContent = 'í˜„ì¬ ì˜ˆë³´ ì •ë³´ê°€ ì—†ì–´ìš”.';
                    messageBox.className = 'message-box';
                }
            } catch (error) {
                console.error('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                errorDisplay.textContent = `ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`;
                errorDisplay.style.display = 'block';
                forecastContainer.innerHTML = '';
                messageBox.textContent = '';
            } finally {
                loadingSpinner.style.display = 'none';
            }
        }

        fetchForecastData();
    </script>
</body>
</html>